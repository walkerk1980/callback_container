FROM ubuntu
RUN apt-get update && DEBIAN_FRONTEND=noninteractive apt-get -o Dpkg::Options::="--force-confnew" --assume-yes -y --yes -f install -y apache2 openssh-server dnsutils nmap nano tcpdump screen tmux scapy python-openssl tshark
RUN /bin/sed -i s/"PermitRootLogin prohibit-password"/"PermitRootLogin yes"/ /etc/ssh/sshd_config
RUN /bin/echo -e "#!/bin/bash\n/bin/bash -c '/usr/bin/msfdb init; while :; do /bin/bash; cat /etc/motd; done'" >>/usr/local/bin/mainThread && chmod +x /usr/local/bin/mainThread
RUN /bin/systemctl enable ssh && echo "To SSH into your container you must first set a root password and start the ssh service!" >>/etc/motd
RUN /bin/echo "To detach from this container press <ctrl+p><ctrl+q>" >>/etc/motd
RUN /bin/echo "To see existing containers run 'engagement -p'" >>/etc/motd
RUN /bin/echo "To run an egress test run 'egressTest.py'" >>/etc/motd
RUN /bin/echo "To reattach to this container run 'engagement -a yourContainerName" >>/etc/motd
#WORKDIR /usr/local/bin/
#COPY Egscape/egscape-server.py /usr/local/bin/egressTest.py 
#RUN chmod +x /usr/local/bin/egressTest.py
#RUN systemctl enable postgresql && msfdb init && echo "deb http://ppa.launchpad.net/webupd8team/java/ubuntu xenial main"|tee /etc/apt/sources.list.d/webupd8team-java.list && echo "deb-src http://ppa.launchpad.net/webupd8team/java/ubuntu xenial main"|tee -a /etc/apt/sources.list.d/webupd8team-java.list && apt-key adv --keyserver hkp://keyserver.ubuntu.com:80 --recv-keys EEA14886 && echo oracle-java8-installer shared/accepted-oracle-license-v1-1 select true|/usr/bin/debconf-set-selections && apt-get update && apt-get install oracle-java8-installer -y && apt-get install oracle-java8-set-default -y
#COPY cobaltstrike-trial.tgz /usr/local/src/cobaltstrike-trial.tgz
#WORKDIR /usr/local/src/
#RUN tar xzvf cobaltstrike-trial.tgz && cp -fr ./cobaltstrike /usr/local/bin/
#WORKDIR /usr/local/bin/cobaltstrike/
#RUN sed -i 's/-classpath .\/cobaltstrike.jar/-classpath \/usr\/local\/bin\/cobaltstrike\/cobaltstrike.jar/' ./teamserver
#RUN /bin/echo "alias teamserver='/usr/local/bin/cobaltstrike/teamserver'" >> /etc/bash.bashrc && /bin/echo "alias cobalt_update='olddir=$(/bin/pwd) && cd /usr/local/bin/cobaltstrike/ && ./update && cd $olddir'" >> /etc/bash.bashrc
#RUN /bin/echo -e "Set Metasploit LHOST to your public IP address(168.215.65.?)\n and set ReverseBindAddress to the IP address of your container(172.17.0.?)" >>/etc/motd
#WORKDIR /root/
